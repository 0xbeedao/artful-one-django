{% extends "site_detail_page.html" %}{% load humanize %}

{% load pictures %}

{% block title %}Photos tagged "{{ photo_tag.name }}" - Bruce Kroeze{% endblock %}

{% block extrahead %}
<meta property="og:type" content="website" />
<meta property="og:title" content="Photos tagged '{{ photo_tag.name }}' - Bruce Kroeze" />
<meta property="og:description" content="{{ photos.count|intcomma }} photo{{ photos.count|pluralize }} tagged '{{ photo_tag.name }}'." />
<meta property="og:site_name" content="Bruce Kroeze's Weblog" />
<style>
.photo-grid {
    display: flex;
    flex-wrap: wrap;
    gap: 1rem;
}

.photo-card {
    flex: 1;
    min-width: 300px;
    display: flex;
    flex-direction: column;
    height: 100%;
}

.photo-card .ui.card {
    height: 100%;
    display: flex;
    flex-direction: column;
}

.photo-card .ui.card .content {
    flex: 1;
    display: flex;
    flex-direction: column;
}

.photo-card .ui.card .content .header {
    margin-bottom: auto;
}

.photo-card .ui.card .image {
    height: 200px;
    overflow: hidden;
}

.photo-card .ui.card .image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}
</style>
{% endblock %}

{% block primary %}
<h2 class="archive-h2">{{ photos.count|intcomma }} photo{{ photos.count|pluralize }} tagged "{{ photo_tag.name }}"</h2>

{% if photo_tag.description %}
    <div class="tag-description">{{ photo_tag.description|linebreaks }}</div>
{% endif %}

{% if photos %}
    <div class="photo-grid">
        {% for photo in photos %}
            <div class="photo-card">
                <div class="ui card">
                    {% if photo.image %}
                        <div class="image">
                            {% picture photo.image picture_id=photo.html_id img_alt="{{ photo.title }}" img_loading="lazy" picture_class="ui fluid image" %}
                        </div>
                    {% endif %}
                    <div class="content">
                        {% if photo.title %}
                            <div class="header">{{ photo.title }}</div>
                        {% endif %}
                        {% if photo.description %}
                            <div class="description">
                                {{ photo.description|truncatewords:20 }}
                            </div>
                        {% endif %}
                        {% if photo.external_url %}
                            <div class="meta">
                                <a href="{{ photo.external_url }}" target="_blank" rel="noopener">
                                    {% if photo.external_title %}{{ photo.external_title }}{% else %}View Original{% endif %}
                                </a>
                            </div>
                        {% endif %}
                        <div class="meta">
                            <span class="date">{{ photo.created|date:"F j, Y" }}</span>
                        </div>
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>
{% else %}
    <p>No photos found with this tag.</p>
{% endif %}
{% endblock %}

{% block secondary %}
<div class="ui container" style="margin-top: 2rem;">
    <div class="ui two column stackable grid">
        <div class="column">
            <p><strong>Photo Tag</strong></p>
            <p>{{ photo_tag.name }}</p>
            
            {% if photo_tag.description %}
                <p><strong>Description</strong></p>
                <p>{{ photo_tag.description|linebreaks }}</p>
            {% endif %}
        </div>
        <div class="column">
            <p><strong>Total Photos</strong></p>
            <p>{{ photos.count|intcomma }} photo{{ photos.count|pluralize }}</p>
        </div>
    </div>
</div>
{% endblock %}
